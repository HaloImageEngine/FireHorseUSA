<!-- src/app/pages/register/register.component.html -->
<div class="main-page register-page">
  <mat-card class="register-card">
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="header-row">
        <h1 class="page-title">
          <span class="logo-fire">Fire</span><span class="logo-horse">Horse</span> Saloon Registration
        </h1>

        <button mat-button type="button" (click)="goToLogin()">
          Already have an account? Login
        </button>
      </div>

      <p class="page-subtitle">
        Create your FireHorse Saloon account to register and participate in our events.
      </p>

      <!-- Server message -->
      <div
        class="server-msg"
        *ngIf="serverMsg.text"
        [ngClass]="{ 'server-msg-error': serverMsg.type === 'error', 'server-msg-info': serverMsg.type === 'info' }"
      >
        <span>{{ serverMsg.text }}</span>
        <button class="server-msg-close" type="button" (click)="closeServerMsg()">Ã—</button>
      </div>

      <!-- User Alias -->
      <div class="grid-row">
        <mat-form-field appearance="outline" class="field full-width">
          <mat-label>User Alias *</mat-label>
          <input
            matInput
            formControlName="userAlias"
            maxlength="20"
            autocomplete="username"
            (input)="onAliasInput($event)"
          />
          <mat-hint>6-20 characters, no spaces (auto-uppercase)</mat-hint>
          <mat-error *ngIf="f['userAlias'].touched && f['userAlias'].invalid">
            {{ f['userAlias'].getError('alias') || 'User alias is required.' }}
          </mat-error>
        </mat-form-field>
      </div>

      <!-- First Name + M.I. -->
      <div class="grid-row">
        <mat-form-field appearance="outline" class="field flex-3">
          <mat-label>First Name *</mat-label>
          <input
            matInput
            formControlName="firstName"
            autocomplete="given-name"
            (input)="onFirstNameInput($event)"
          />
          <mat-hint>Letters only</mat-hint>
          <mat-error *ngIf="f['firstName'].touched && f['firstName'].invalid">
            <span *ngIf="f['firstName'].hasError('required')">First name is required.</span>
            <span *ngIf="f['firstName'].hasError('pattern')">Letters only.</span>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="field flex-1">
          <mat-label>M.I.</mat-label>
          <input
            matInput
            formControlName="middleInitial"
            autocomplete="additional-name"
            maxlength="1"
            (input)="onMiddleInitialInput($event)"
          />
          <mat-error *ngIf="f['middleInitial'].touched && f['middleInitial'].invalid">
            M.I. must be a single letter.
          </mat-error>
        </mat-form-field>
      </div>

      <!-- Last Name -->
      <div class="grid-row">
        <mat-form-field appearance="outline" class="field full-width">
          <mat-label>Last Name *</mat-label>
          <input
            matInput
            formControlName="lastName"
            autocomplete="family-name"
            (input)="onLastNameInput($event)"
          />
          <mat-hint>Letters only</mat-hint>
          <mat-error *ngIf="f['lastName'].touched && f['lastName'].invalid">
            <span *ngIf="f['lastName'].hasError('required')">Last name is required.</span>
            <span *ngIf="f['lastName'].hasError('pattern')">Letters only.</span>
          </mat-error>
        </mat-form-field>
      </div>

      <!-- Login email -->
      <div class="grid-row">
        <mat-form-field appearance="outline" class="field full-width">
          <mat-label>Login Email *</mat-label>
          <input
            matInput
            formControlName="email"
            autocomplete="email"
            inputmode="email"
          />
          <mat-hint>Used as your login and account username</mat-hint>
          <mat-error *ngIf="f['email'].touched && f['email'].invalid">
            <span *ngIf="f['email'].hasError('required')">Login email is required.</span>
            <span *ngIf="f['email'].hasError('email')">Enter a valid email.</span>
          </mat-error>
        </mat-form-field>
      </div>

      <!-- Password -->
      <div class="grid-row">
        <mat-form-field appearance="outline" class="field full-width">
          <mat-label>Password *</mat-label>
          <input
            matInput
            [type]="showPassword() ? 'text' : 'password'"
            formControlName="password"
            autocomplete="new-password"
          />
          <button
            mat-icon-button
            matSuffix
            type="button"
            aria-label="Toggle password visibility"
            (click)="toggleShowPassword()"
          >
            <mat-icon>{{ showPassword() ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
          <mat-hint>Min 8 characters recommended</mat-hint>
          <mat-error *ngIf="f['password'].touched && f['password'].invalid">
            <span *ngIf="f['password'].hasError('required')">Password is required.</span>
            <span *ngIf="f['password'].hasError('minlength')">Min 8 characters recommended.</span>
          </mat-error>
        </mat-form-field>
      </div>

      <!-- Zip + Phone row -->
      <div class="grid-row">
        <mat-form-field appearance="outline" class="field flex-1">
          <mat-label>Zip</mat-label>
          <input
            matInput
            formControlName="zip"
            autocomplete="postal-code"
            inputmode="numeric"
            maxlength="5"
            (input)="onZipInput($event)"
          />
          <mat-hint>Optional; 5 digits</mat-hint>
          <mat-error *ngIf="f['zip'].touched && f['zip'].invalid">
            {{ f['zip'].getError('zip') }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="field flex-1">
          <mat-label>Phone</mat-label>
          <input
            matInput
            formControlName="phoneNum"
            autocomplete="tel"
            inputmode="tel"
            maxlength="12"
            placeholder="1234567890"
            (input)="onPhoneInput($event)"
          />
          <mat-hint>Optional; enter 10 digits (will format as 123-456-7890)</mat-hint>
          <mat-error *ngIf="f['phoneNum'].touched && f['phoneNum'].invalid">
            {{ f['phoneNum'].getError('phoneNum') }}
          </mat-error>
        </mat-form-field>
      </div>

      <!-- Actions -->
      <div class="button-row">
        <button
          mat-raised-button
          color="primary"
          type="submit"
          [disabled]="submitting()"
        >
          {{ submitting() ? 'Submitting...' : 'Create Account' }}
        </button>

        <button
          mat-stroked-button
          type="button"
          (click)="onReset()"
          [disabled]="submitting()"
        >
          Reset
        </button>
      </div>
    </form>
  </mat-card>
</div>
